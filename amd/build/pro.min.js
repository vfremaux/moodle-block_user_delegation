define(["jquery","core/log","core/config","core/str"],function(a,b,c,d){var e={init:function(){a("#id_s_block_user_delegation_licensekey").bind("change",this.check_product_key),a("#id_s_block_user_delegation_licensekey").trigger("change"),b.debug("AMD Pro js initialized for user_delegation")},check_product_key:function(){that=a(this);var b=that.val().replace(/-/g,""),d=b.substr(0,14),f=b.substr(14,2),g=e.checksum(d),h=' <img src="'+c.wwwroot+'/pix/i/valid.png">',i=' <img src="'+c.wwwroot+'/pix/i/warning.png">',j=' <img src="'+c.wwwroot+'/pix/i/invalid.png">',k=' <img src="'+c.wwwroot+'/pix/i/ajaxloader.gif">';f==g?(url=c.wwwroot+"/blocks/user_delegation/pro/ajax/services.php?",url+="what=license",url+="&service=check",url+="&customerkey="+that.val(),url+="&provider="+a("#id_s_block_user_delegation_licenseprovider").val(),a("#id_s_block_user_delegation_licensekey + img").remove(),a("#id_s_block_user_delegation_licensekey").after(k),a.get(url,function(b){b.match(/SET OK/)?(a("#id_s_block_user_delegation_licensekey + img").remove(),a("#id_s_block_user_delegation_licensekey").after(h)):(a("#id_s_block_user_delegation_licensekey + img").remove(),a("#id_s_block_user_delegation_licensekey").after(j))},"html")):(a("#id_s_block_user_delegation_licensekey + img").remove(),a("#id_s_block_user_delegation_licensekey").after(i))},checksum:function(a){var b="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ",c=b.split(""),d=c.length,e=a.split(""),f=0;for(ch in e){var g=e[ch].charCodeAt(0);f+=g}var h=Math.floor(f/d)%d,i=f%d;return""+c[i]+c[h]}};return e});