{"version":3,"file":"upload_users_form.min.js","sources":["../src/upload_users_form.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\ndefine(['jquery', 'core/log', 'core/config', 'core/str'], function($, log, cfg, str) {\n\n    var upload_users_form = {\n\n        strs: [],\n\n        init: function() {\n\n            $('#id_coursetoassign').change(function() {\n                upload_users_form.load_course_groups();\n            });\n\n            // Fetch some strings.\n            str.get_strings([{\n                key: 'addnewgroup',\n                component: 'block_user_delegation'\n            }, {\n                key: 'loadinggroups',\n                component: 'block_user_delegation'\n            }, {\n                key: 'nogroups',\n                component: 'block_user_delegation'\n            }, {\n                key: 'nogroupassign',\n                component: 'block_user_delegation'\n            }\n            ]).then(function(results) {\n                upload_users_form.strs['addnewgroup'] = results[0];\n                upload_users_form.strs['loadinggroups'] = results[1];\n                upload_users_form.strs['nogroups'] = results[2];\n                upload_users_form.strs['nogroupassign'] = results[3];\n            });\n\n            this.load_course_groups();\n\n            log.debug(\"AMD User delegation upload users initialized.\");\n        },\n\n        load_course_groups: function () {\n\n            var courseid = $('#id_coursetoassign').val();\n            var skey = $(\"[name='sesskey']\").val();\n\n           if (courseid === '' || courseid === null || courseid === 0) {\n                log.debug(\"No course selected\");\n                $('#fitem_id_newgroupname').hide();\n                $('#id_grouptoassign').empty();\n                $('#id_grouptoassign').append(\"<option>\" + upload_users_form.strs['loadinggroups'] + \"</option>\");\n           } else {\n                $('#id_grouptoassign').empty();\n                $('#id_grouptoassign').append(\"<option>\" + upload_users_form.strs['nogroupassign'] + \"</option>\");\n\n                var params = {\n                    action: 'GetCourseGroups',\n                    sesskey: skey,\n                    cid: courseid\n                };\n                var coursesurl = cfg.wwwroot + \"/blocks/user_delegation/serverside/service.php\";\n                $.getJSON(coursesurl, params, function(data) {\n                    $('#id_grouptoassign').empty();\n                    $('#id_grouptoassign').append(\"<option value='-1'><b>\" +\n                        upload_users_form.strs['addnewgroup'] + \"</b></option>\");\n                    if (data.result == false) {\n                        $('#id_grouptoassign').append(\"<option>\" +\n                            upload_users_form.strs['nogroups'] + \"</option>\");\n                    } else {\n                        $('#id_grouptoassign').append(\"<option value='0'><b>\" +\n                            upload_users_form.strs['nogroupassign'] + \"</b></option>\");\n                        $.each(data.result, function(i, obj) {\n                        $('#id_grouptoassign').append(\"<option value='\" + obj.id + \"'>\" + obj.name + \"</option>\");\n                        });\n                    }\n\n                    $('#id_grouptoassign').on('change', function() {\n                        var selected_value = $('#id_grouptoassign option:selected').val();\n                        if (selected_value == -1) {\n                            $('#fitem_id_newgroupname').show();\n                        } else {\n                            $('#fitem_id_newgroupname').hide();\n                        }\n                    });\n                });\n            }\n        }\n    };\n\n    return upload_users_form;\n});\n"],"names":["define","$","log","cfg","str","upload_users_form","strs","init","change","load_course_groups","get_strings","key","component","then","results","this","debug","courseid","val","skey","hide","empty","append","params","action","sesskey","cid","coursesurl","wwwroot","getJSON","data","result","each","i","obj","id","name","on","show"],"mappings":"AAeAA,iDAAO,CAAC,SAAU,WAAY,cAAe,YAAa,SAASC,EAAGC,IAAKC,IAAKC,KAE5E,IAAIC,kBAAoB,CAEpBC,KAAM,GAENC,KAAM,WAEFN,EAAE,sBAAsBO,OAAO,WAC3BH,kBAAkBI,oBACtB,GAGAL,IAAIM,YAAY,CAAC,CACbC,IAAK,cACLC,UAAW,yBACZ,CACCD,IAAK,gBACLC,UAAW,yBACZ,CACCD,IAAK,WACLC,UAAW,yBACZ,CACCD,IAAK,gBACLC,UAAW,2BAEZC,KAAK,SAASC,SACbT,kBAAkBC,KAAkB,YAAIQ,QAAQ,GAChDT,kBAAkBC,KAAoB,cAAIQ,QAAQ,GAClDT,kBAAkBC,KAAe,SAAIQ,QAAQ,GAC7CT,kBAAkBC,KAAoB,cAAIQ,QAAQ,EACtD,GAEAC,KAAKN,qBAELP,IAAIc,MAAM,gDACb,EAEDP,mBAAoB,WAEhB,IAAIQ,SAAWhB,EAAE,sBAAsBiB,MACnCC,KAAOlB,EAAE,oBAAoBiB,MAElC,GAAiB,KAAbD,UAAgC,OAAbA,UAAkC,IAAbA,SACvCf,IAAIc,MAAM,sBACVf,EAAE,0BAA0BmB,OAC5BnB,EAAE,qBAAqBoB,QACvBpB,EAAE,qBAAqBqB,OAAO,WAAajB,kBAAkBC,KAAoB,cAAI,iBACnF,CACFL,EAAE,qBAAqBoB,QACvBpB,EAAE,qBAAqBqB,OAAO,WAAajB,kBAAkBC,KAAoB,cAAI,aAErF,IAAIiB,OAAS,CACTC,OAAQ,kBACRC,QAASN,KACTO,IAAKT,UAELU,WAAaxB,IAAIyB,QAAU,iDAC/B3B,EAAE4B,QAAQF,WAAYJ,OAAQ,SAASO,MACnC7B,EAAE,qBAAqBoB,QACvBpB,EAAE,qBAAqBqB,OAAO,yBAC1BjB,kBAAkBC,KAAkB,YAAI,iBACzB,GAAfwB,KAAKC,OACL9B,EAAE,qBAAqBqB,OAAO,WAC1BjB,kBAAkBC,KAAe,SAAI,cAEzCL,EAAE,qBAAqBqB,OAAO,wBAC1BjB,kBAAkBC,KAAoB,cAAI,iBAC9CL,EAAE+B,KAAKF,KAAKC,OAAQ,SAASE,EAAGC,KAChCjC,EAAE,qBAAqBqB,OAAO,kBAAoBY,IAAIC,GAAK,KAAOD,IAAIE,KAAO,YAC7E,IAGJnC,EAAE,qBAAqBoC,GAAG,SAAU,YAET,GADFpC,EAAE,qCAAqCiB,MAExDjB,EAAE,0BAA0BqC,OAE5BrC,EAAE,0BAA0BmB,MAEpC,EACJ,EACJ,CACJ,GAGJ,OAAOf,iBACX"}